<!DOCTYPE html>
<html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>岗位-考勤系统</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel="stylesheet" href="../static/css/font.css" th:href="@{/css/font.css}">
		<link rel="stylesheet" href="../static/css/weadmin.css" th:href="@{/css/weadmin.css}">
		<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
		<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

		<!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
		<!--[if lt IE 9]>
	      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
	      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
	    <![endif]-->
		<style type="text/css">
			.layui-form-label{
				width: 120px;
			}
			.layui-form-item{
				margin-bottom: 7px;
			}
			.layui-input{
				border-color: #3F3F3F;
			}
		</style>
	</head>

	<body>
		<div class="weadmin-nav">
			<span class="layui-breadcrumb">
        <a href="">首页</a>
        <a href="">公司架构</a>
        <a>
          <cite>岗位</cite></a>
      </span>
			<a class="layui-btn layui-btn-sm" style="line-height:1.6em;margin-top:3px;float:right" href="javascript:location.replace(location.href);" title="刷新">
				<i class="layui-icon" style="line-height:30px">&#x1002;</i></a>
		</div>
		<div class="weadmin-body">
			<div class="layui-row">

					<div class="layui-inline">
						<input type="text" name="staCode" placeholder="请输入岗位编码" autocomplete="off" class="layui-input">
					</div>
					<button class="layui-btn" lay-submit="" lay-filter="sreach"><i class="layui-icon">&#xe615;</i></button>

            </div>
			<div class="weadmin-block">
					<button class="layui-btn layui-btn-danger" onclick="stasDelete()"><i class="layui-icon"></i>批量删除</button>
					<!--<form action="" th:action="@{/sta/goToAddHtml}" th:method="get">-->
					<!--<button class="layui-btn" type="submit"><i class="layui-icon"></i>添加</button>-->
				<!--添加弹窗-->
				<button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
					添加
				</button>
				<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
									&times;
								</button>
								<h4 class="modal-title" id="myModalLabel">
									添加
								</h4>
							</div>
							<div class="weadmin-body">
								<form class="layui-form" th:action="@{/sta/addStation}" method="post">
									<h1 style="color:red" th:text="${msg}" th:if="${not #strings.isEmpty(msg)}"></h1>
									<div class="layui-form-item">
										<label for="L_username" class="layui-form-label">
											<span class="we-red">*</span>岗位编码
										</label>
										<div class="layui-input-inline">
											<input type="text" id="L_username" name="staCode" lay-verify="required|nikename" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item">
										<label  class="layui-form-label">
											<span class="we-red">*</span>岗位名称
										</label>
										<div class="layui-input-inline">
											<input type="text" id="L_name" name="staName" lay-verify="required|name" autocomplete="" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item">
										<label class="layui-form-label">
											<span class="we-red">*</span>所在部门
										</label>
										<div class="layui-input-inline">
											<input type="text" id="L_salary" name="staDep" lay-verify="required|salary" autocomplete="off" class="layui-input">
											<!--						<select>-->
											<!--							<option value ="ZCS">ZCS-总裁室</option>-->
											<!--							<option value ="CWB">CWB-caiwubu </option>-->
											<!--							<option value="HR">HR-人力资源部</option>-->
											<!--						  </select>	-->
										</div>
									</div>
									<div class="layui-form-item">
										<label  class="layui-form-label">
											<span class="we-red">*</span>直接上级编码
										</label>
										<div class="layui-input-inline">
											<input type="text" id="L_salary" name="staBoss" lay-verify="required|salary" autocomplete="off" class="layui-input">

										</div>
									</div>
									<div class="layui-form-item">
										<label  class="layui-form-label">
											<span class="we-red">*</span>岗位类别
										</label>
										<div class="layui-input-inline">
											<input type="text" id="L_salary" name="staCate" lay-verify="required|salary" autocomplete="off" class="layui-input">
											<select>
												<option value ="GL">管理类</option>
												<option value ="WZ">文职类</option>
												<option value="JS">技术类</option>
											</select>
										</div>
									</div>
									<div class="layui-form-item">
										<label class="layui-form-label">
											<span class="we-red">*</span>职责描述
										</label>
										<div class="layui-input-inline">
											<input type="textarea" id="L_salary" name="staDes" lay-verify="required|salary" autocomplete="off" class="layui-input">
										</div>
									</div>





									<div class="layui-form-item">
										<label class="layui-form-label">
										</label>
										<button class="layui-btn" lay-filter="add" lay-submit="">确定</button>
									</div>
								</form>
							</div>
						</div><!-- /.modal-content -->
					</div><!-- /.modal -->
				</div>
				<!--</form>-->
				<span class="fr" style="line-height:40px">共有数据：88 条</span>
			</div>
			<table class="layui-table" id="memberList">
				<thead>
					<tr>
						<th>
							<input type="checkbox" />
						</th>
						<th>ID</th>
						<th>岗位编码</th>
						<th>岗位名称</th>
						<th>所在部门</th>
						<th>直接上级</th>
						<th>岗位类别</th>
						<th>操作</th>
					</tr>
				</thead>
                <tbody id="tbody" >

                </tbody>
			</table>


            <div id='ulList' class="page">

            </div>
			</div>
		</div>

		<!--       ************************************************************************  -->

		<!--<script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>-->
		<script src="../lib/layui/layui.js" charset="utf-8" th:src="@{/layui/layui.js}"></script>
		<script src="../static/js/eleDel.js" type="text/javascript" charset="utf-8" th:src="@{/js/eleDel.js}"></script>
		<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
		<script type="text/javascript">

			function stasDelete() {

				if (confirm("确定删除选中的用户？")) {
					var staList = new Array();
					$("input[name='stasDelete']:checked").each(function () {
						staList.push($(this).val());
					});
					$.ajax({
						type: "post",
						url: "/sta/stasDel",
						data: {staList: staList.toString()},
						success: function () {
							alert("删除成功！");
							location.reload();
						},
						error: function () {
							alert("刪除失败！")
						}
					});
				}
			}
		</script>


        <script th:inline="none">
            var currentPage = 0;
            function loadData(key,page, pageSize) {
                $.ajax({
                    type: 'POST',
                    url: "/sta",
                    dataType: "json",
                    data: {staCode: key,
                        pageSize:5,
                        currentPage:page},
                    success: function (data) {
                        $("#tbody").html("");
                        // $("#ulList").html("");
                        var tabledata = data['stas'];
                        jQuery.each(tabledata, function (i, list) {
                            var tr="";
                            tr+="<tr>"+
                                "<td><input name=\"stasDelete\" value=" + list['id'] + " type=\"checkbox\" /></td>"+
                                "<td>" + list['id'] + "</td>"+
                                "<td>" + list['staCode'] + "</td>"+
                                "<td>" + list['staName'] + "</td>"+
                                "<td>" + list['staDep'] + "</td>"+
                                "<td>" + list['staBoss'] + "</td>"+
                                "<td>" + list['staCate'] + "</td>"+
                                "<td>" + list['staDes'] + "</td>"+
                                "<td class=\"td-manage\">"+
                                "<button class=\"btn btn-primary btn-lg\" id="+ list['id'] + " onclick=\"clickEdit(this)\" data-toggle=\"modal\" data-target=\"#updateEmpPage\">"+
                                "编辑用户"+
                                "</button>"+
                                "<form action=\"/test/" + list['id'] + " method=\"post\" >"+
                                "<input type=\"hidden\" name=\"_method\" value=\"delete\" />"+
                                "<button  type=\"submit\" >删除</button>"+
                                "</form>"+
                                "</td></tr>";

                            $("#tbody").append(tr);
                        });
                        $("#ulList").html('');
                        var li="<a class=\"num\" onclick='loadData(\"\","+(currentPage-1)+","+5+")'><<</a>";
                        for (var i = 1; i <= data['pageNum']; i++) {
                            if (i==currentPage){
                                li+="<a class=\"current\" class='active' onclick='loadData(\"\","+i+", "+5+")'>"+i+"</a>";
                            }
                            else {
                                li+="<a class=\"num\" onclick='loadData(\"\","+i+", "+5+")'>"+i+"</a>";
                            }
                        }
                        li+="<a class=\"num\" onclick='loadData(\"\","+(currentPage+1)+","+5+")'>>></a>";
                        $("#ulList").append(li);
                        // console.log(tr);
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        console.log(XMLHttpRequest.status);
                        console.log(XMLHttpRequest.readyState);
                        console.log(textStatus);
                    }
                });
            }

            $(document).ready(function () {
                loadData('', 1, 5);
            })

        </script>
	</body>

</html>